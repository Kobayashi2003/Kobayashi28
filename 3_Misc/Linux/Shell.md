# Shell

[toc]

## 脚本执行

- 赋予执行权限，直接执行
  - chmod 755 hello.sh
  - ./hello.sh
- 通过Bash调用执行脚本
  - bash hello.sh

## echo输出命令

echo [-e] [输出内容]

-e 支持反斜线控制的字符转换

## dos2unix

dos to unix

## 命令执行顺序
1. 第一顺位执行用绝对路径或相对路径执行的命令
2. 第二顺位执行别名
3. 第三顺位执行Bash的内部命令
4. 第四顺位执行按照$PATH环境变量定义的目录查找顺序找到的第一个命令

## 历史命令

`history [-cw] [历史命令保存文件]`

-c 清空历史命令

-w 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history

- 使用上下箭头查看历史命令
- 使用`!n`重复执行第n条历史命令
- 使用`!!`重复执行上一条命令
- 使用`!字串`重复执行最后一条以该字串开头的命令

## 命令别名

- 设定命令别名：`alias 别名='原命令'`

- 查询命令别名：`alias`

- 永久设置别名：`vi /root/.bashrc`

- 删除别名：`unalias`


## Bash常用快捷键

- `ctrl+A` 把光标移动到命令行开头
- `ctrl+E` 把光标移动到命令行结尾
- `ctrl+C` 强制终止当前的命令
- `ctrl+U` 删除或剪切光标之前的命令
- `ctrl+K` 删除或剪切光标之后的内容
- `ctrl+Y` 粘贴ctrl+U或ctrl+K截切的内容
- `ctrl+R` 在历史命令中搜索
- `ctrl+D` 退出当前终端
- `ctrl+Z` 暂停，并放入后台
- `ctrl+S` 暂停屏幕输出
- `ctrl+Q` 恢复屏幕输出


## 输入输出重定向

设备文件名|文件描述符|类型
-|-|-
/dev/stdin|0|标准输入
/dev/stdout|1|标准输出
/dev/stderr|2|标准错误输出


## 输出重定向

### 标准输出重定向

符号|作用
-|-
命令>文件|以覆盖的方式，把命令的正确输出输出到指定的文件或设备当中
命令>>文件|以追加的方式，把命令的正确输出输出到指定的文件或设备当中

### 标准错误输出重定向

符号|作用
-|-
错误命令 2>文件|以覆盖的方式，把命令的错误输出输出到指定的文件或设备当中
错误命令 2>>文件|以追加的方式，把命令的错误输出输出到指定的文件或设备当中

### 正确输出和错误输出同时保存

符号|作用
-|-
命令 > 文件 2>&1|以覆盖的方式，把正确的输出和错误的输出都保存到同一个文件当中
命令 >> 文件 2>&1|以追加的方式，把正确的输出和错误的输出都保存到同一个文件当中
命令 &> 文件|以覆盖的方式，把正确的输出和错误的输出都保存到同一个文件当中
命令 &>> 文件|以追加的方式，把正确的输出和错误的输出都保存到同一个文件当中
命令>>文件1 2>>文件2|把正确的输出追加到文件1中，把错误的输出追加到文件2中


## 多命令顺序执行

多命令执行符|格式|作用
-|-|-
:|命令1:命令2|多个命令顺序执行，命令之间没有任何逻辑联系
&&|命令1&&命令2|逻辑与
\|\||逻辑或


应用：
`dd if=输入文件 of=输出文件 bs=字节数 count=个数`


## 管道符

命令1 | 命令2

命令1的正确输出作为命令2的操作对象


## grep

`grep [选项] "搜索内容"`

选项：
-i 忽略大小写
-n 输出行号
-v 反向查找
--color=auto 搜索出的关键字用颜色显示

## 通配符

通配符|作用
-|-
?|匹配一个任意字符
*|匹配0个或任意多个任意字符
[]|匹配中括号中任意一个字符
[-]|匹配中括号中任意一个字符，-代表一个范围
[^]|逻辑非，表示匹配不是中括号内的一个字符



## Bash中其它特殊符号

符号|作用

-|-

''|单引号，在单引号中所有的特殊符号都没有特殊含义
""|双引号，在双引号中特殊符号都没有特殊含义，但是 $、`、\ 是例外
``|反引号，反引号括起来的命令是系统命令，在Bash中会先执行它
${}|和反引号作用一样，用来引用系统命令
#|在Shell脚本中，#开头的行代表注释
$|用于调用变量的值
\|转义符，跟在\之后的特殊符号将失去特殊含义


## 变量

- 默认类型都是字符串类型，如果要进行数值运算，则必须指定变量类型为数值型
- 变量用等号连接值，等号左右两侧不能有空格
- 如果需要增加变量的值，那么可以进行变量值的叠加。不过变量需要用双引号包含 “$变量名” 或用 ${变量名} 包含
- 如果是把命令的结果作为变量值赋予变量，则需要使用反引号或$()包含命令
- 环境变量名建议大写，便于区分

### 变量分类

- 用户自定义变量
- 环境变量：这种变量中主要保存的是和系统操作环境相关的数据
- 位置参数变量：这种变量主要是用来向脚本当中传递参数或数据的，变量名不能自定义，变量作用是固定的
- 预定义变量：是 Bash 中已经定义好的变量，变量名不能自定义，变量作用也是固定的

### 变量定义

`name="kobayashi"`

### 变量定义

```
aa=123
aa="$aa"456
aa=${aa}789
```

### 变量调用

`ehco $name`

### 变量查看

`set`

### 变量删除

`unset name`


## 环境变量

### source命令

`source 配置文件`

缩写 `. 配置文件`

### 环境变量配置文件简介

环境变量配置文件中主要是定义对系统的操作环境生效的系统默认环境变量，比如 PATH、HISTSIZE、PSI、HOSTNAME 等默认环境变量

> /etc/profile

作用：
- USER变量
- LOGNAME变量
- MAIL变量
- PATH变量
- HOSTNAME变量
- HISTSIZE变量
- umask:
- 调用/etc/profile.d/*.sh文件

> /etc/profile.d/*.sh

> ~/.bash_profile

作用：
- 调用了~/.bashrc文件
- 在PATH变量后面加入了 “$HOME/bin”这个目录

> ~/.bashrc

> /etc/bashrc

作用：
- PSI 变量
- umask
- PATH变量
- 调用 etc/profile.d/*sh 文件
