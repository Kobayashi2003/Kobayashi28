#### R1  列出 5 种非专用的因特网应用及它们所使用的应用层协议。

> 浏览器：HTTP 协议
> 
> 文件传输：FTP 协议
> 
> 远程登陆：telnet
> 
> 邮件：SMTP
> 
> P2P 文件共享：BitTorrent 

#### R2  网络体系结构与应用程序体系结构之间有什么区别？

> 网络体系结构是将端系统间的数据交换过程按照层次划分，每层提供相应的服务，层次之间各司其职不耦合，这样每层都可以在进行扩展而不会影响其他层提供的服务；
> 
> 应用程序体系结构是设计来让应用程序提供更好的服务而衍生出来的不同方案，比如浏览器和 Web 服务器这样的 B/S 结构；App 和数据服务器这样的 C/S 结构，以及迅雷下载这样的 P2P 结构。其中一台端系统负责运行客户端程序，一台负责全天候 24 小时运行着提供数据服务的程序。

#### R3  对两进程之间的通信会话而言，哪个进程是客户，哪个进程是服务器？

> 主动发起连接的是客户，被动响应的是服务器。

#### R4 对一个 P2P 文件共享应用，你同意 “一个通信会话不存在客户端和服务器端的概念” 的说法吗？为什么？

> 不同意，P2P 文件共享应用中，收到文件的就是客户端，发送文件的就是服务器，虽然同一个主机会既充当文件的接受者，也充当文件的上传者。

#### R5 运行在一台主机上的一个进程，使用什么信息来标示运行在另一台主机上的进程？

> IP 地址 + 端口号

#### R6 假定你想尽快第处理从远程客户到服务器的事物，你将使用 UDP 还是 TCP？为什么？ 

> UDP，使用 UDP 可以在一个 RTT 时间内得到返包，而使用 TCP 的话，至少需要两个 RTT，包括三次握手阶段。 

#### R7 参见图 2-4，我们看到在该图中所列出的应用程序没有一个同时既要求无数据丢失又要求定时的。你能设想一个既要求无数据丢失又高度时间敏感的应用吗？

> 同声传译

#### R8  列出一个运输协议能够提供的 4 种宽泛类型的服务。对于每种服务，指出是 UDP 还是 TCP (或这两种协议) 提供这样的服务。

> 可靠数据传输 -- TCP ✅ UDP ❌
> 
> 吞吐量 -- TCP ❌ UDP ❌
> 
> 定时 -- TCP ❌ UDP ❌
> 
> 安全性 -- TCP ❌ UDP ❌

#### R9 前面讲过 TCP 能用 SSL 来强化，以提供进程到进程的安全性服务，包括加密。SSL 运行在运输层还是应用层？如果某应用程序研制者想用 SSL 来强化 TCP，该研制者应当做些什么工作？

> SSL 运行在应用层
> 
> 需要包含 SSL 的库，[openssl](https://github.com/openssl/openssl)

#### R10 什么是握手协议？

> 两个端系统第一次进行数据交换时，采取一系列控制数据包的收发操作来进行预备动作，SMTP 协议会在应用层进行握手，而 HTTP 协议不会。

#### R11 为什么 HTTP，FTP，SMTP 及 POP3 都运行在 TCP，而不是 UDP 上？

> 这些应用层协议需要运输层协议提供数据无差错，无冗余并以正确顺序交付的服务，TCP 提供这样的服务，而 UDP 没有提供。

#### R12 考虑一个电子商务网站需要保留每一个客户的购买记录。描述如何使用 cookie 来完成该功能？

> 当用户第一次访问该网站时，服务器为该用户创建一个唯一标识符，并将其存放在后端数据库中，然后通过 HTTP 响应报文将该唯一标识符返回给浏览器，浏览器保存该条 cookie 记录，并在接下来的一系列 HTTP 请求报文中，都将该唯一标识符设置在首部行的 Cookie: 字段中，这样网站就能精确定位该用户的操作。

#### R13  描述 Web 缓存器时如何减少接收被请求的对象的时延的。Web 缓存器将减少一个用户请求的所有对象或只是其中的某些对象的时延吗？为什么？

> Web 缓存器由 ISP 购置一台或多台，可以更改浏览器的配置而使其指向 Web 缓存器，接着发往初始服务器的请求都将被转发到 Web 缓存器，而 Web 缓存器会将初始服务器的数据副本存储一份，因为 Web 缓存器比初始服务器离发出请求的主机更近，因此减少了传输时延和传播时延，处理时延甚至是排队时延。
> 
> Web 缓存器将减少一个用户请求所有对象的时延，对于被 Web 缓存器缓存的数据来说，该时延通过传播，传输，处理和排队时延的减少而减少。对于没有被 Web 缓存器缓存的数据来说，因为因特网上的总流量减少了，因此请求和响应报文在中间某个路由器被排队的可能性就减小，因此时延得到减少。

#### R14  Telnet 到一台 Web 服务器并发送一个多行的请求报文。在该请求报文中包含 If-Modified-Since: 首部行，迫使响应报文中出现 "304 Not Modified" 状态代码。

> // TODO 
> 
> 原理懂，就是将首部行 `If-Modified-Since: xxxx` 后面的时间设置为大于请求对象的最后修改时间，但硬是没搞出来，用 telnet 连了很多 Web 服务器，要么无法通过路径定位到 html 文件，要么可以定位到，但是返回的 Last-Modified 时间并非文件最新修改时间，而是响应的时间。

#### R15  为什么说 FTP 在 "带外" 发送控制信息？

> 因为 FTP 协议的控制请求报文在单独的一条 TCP 连接上发送的，而文件数据在另一条并行的 TCP 连接上传送。

#### R16  假定 Alice 使用一个基于 Web 的电子邮件账户（例如 Hotmail 或 gmail）向 Bob 发报文，而 Bob 使用 POP3 从他的邮件服务器访问自己的邮件。讨论是怎样从 Alice 主机到 Bob 主机得到该报文的。要列出在两台主机间移动该报文时所使用的各种应用层协议。

> Alice 通过 HTTP 协议将邮件报文发送到自己的邮件服务器上，源邮件服务器通过 SMTP 协议将邮件报文推给目的邮件服务器，然后 Bob 通过 POP3 协议将邮件从自己的邮件服务器拉取回来。

#### R17 将你最近收到的报文首部打印出来。其中有多少 Recieved: 首部行？分析该报文的首部行中的每一行。

> // TODO
> 
> 使用 telnet pop.163.com 110 建立一个到网易邮箱 POP3 服务器的 TCP 连接，然后使用 list 和 retr 指令查看邮件内容，但是字段太多了暂时未全部查到是什么意思

#### R18 从用户的观点看，POP3 协议中下载并删除模式和下载并保留模式有什么区别吗？

> 有区别
> 
> 下载并删除的话，那么用户只能在一台主机上接收该邮件并查看，若用户想在另一台主机上办公，查看那封邮件的话，因为已经下载过，所以在邮件服务器上没有保留，这会非常不方便。而下载并保留的话，用户可以在不同的主机上都能查看同一封邮件

#### R19 一个机构的 Web 服务器和邮件服务器可以有完全相同的主机名别名（例如：foo.com） 吗？包含邮件服务器主机名的 RR 有什么样的类型？

> 可以完全相同
> 
> 包含邮件服务器主机名的 RR 可以有 MX、A类型
> 
> MX 类型完成邮件服务器主机名到邮件服务器规范主机名的映射
> 
> A 类型完成邮件服务器规范主机名到邮件服务器 IP 地址的映射
> 
> // TODO 
> 
> 会不会有 NS 类型？？

#### R20 仔细检查收到的电子邮件，查找由使用 .edu 电子邮件地址的用户发送的报文首部。从其首部，能够确定发送该报文的主机的 IP 地址吗？对于由 gmail 账号发送的报文做相同的事。

> // TODO 找不到 .edu 结尾的邮箱
> 
> // TODO 谷歌到网易邮箱中的邮件用 list 拉取不到？？？

#### R21  在 BitTorrent 中，假定 Alice 在 30 秒内始终向 Bob 提供块，Bob 是否一定会偏向于在此 30 秒内也向 Alice 提供块呢？为什么会或者为什么不会？

> Bob 不一定会向 Alice 也提供块，除非 Alice 给 Bob 提供块的速率足够快，以至于成为给 Bob 传块速率最高的四位上传者之一，那么此时 Bob 就也会向 Alice 提供块，这叫 “一报还一报”。因为每过 30 秒钟，Bob 会挑选一个新的对象给它发送块，所以题目中限定了 30 秒的时间间隔。

#### R22 考虑一个新对等方 Alice 加入 BitTorrent 而不拥有任何文件块。没有任何块，因此她没有任何东西可上载，她无法成为任何其他对等方的前 4 位上载者。那么 Alice 将怎样得到她的第一个文件块呢？

> 每个对等方都会每隔 30 秒挑选一个任意的对等方并将自己拥有的块传输给它，这样当 Alice 拥有第一个文件块后，就能够响应别的块请求，也就有机会成为别的对等方的 4 位最高速率上载者之一。 

#### R23  覆盖网络是什么？它包括路由器吗？在覆盖网络中边是什么？

> 在 P2P 文件共享中，覆盖网络是由参与文件共享的节点和节点之间的逻辑连接构成的组织，它不包括路由器，仅仅包括主机和主机之间的 TCP 连接，在覆盖网络中边是两个节点（主机）之间的 TCP 连接。

#### R24 考虑一个具有网状覆盖网络拓扑的 DHT (即每个对等方跟踪系统中的所有对等方)。这样设计的优点和缺点是什么？环形（DHT）无捷径的优点和缺点是什么？

> 对于前者
> 
> 优点：将报文传输到任何一个对等方，只需要一跳
> 
> 缺点：每个对等方都需要维护其他所有对等方的 TCP 连接；每个报文都需要发送给其他所有对等方
> 
> 对于后者：
> 
> 优点：每个对等方只需要维护其他两个对等方的 TCP 连接；
> 
> 缺点：将报文传输到任何一个对等方，最坏情况下可能需要 N 跳。

#### R25 列出至少 4 个不同的应用，它们本质上是和 P2P 体系结构。

> 分布式计算
> 
> 直播
> 
> 文件共享
> 
> 即时通讯

####  R26 2.7 节中所描述的 UDP 服务器仅需要一个套接字，而 TCP 服务器需要两个套接字。为什么？如果 TCP 服务器支持 n 个并行连接，每条连接来自不同的客户主机，那么 TCP 服务器将需要多少个套接字？

> UDP 没有欢迎套接字，UDP 的连接和发送都是通过一个套接字进行的。而 TCP 需要一个欢迎套接字建立三次握手过程，当连接建立时，又创建一个新套接字用于通信，所以如果 TCP 服务器需要支持 n 个并行连接，那么需要有 n + 1 个套接字。

#### R27 对于 2.7 节所描述的运行在 TCP 之上的客户-服务器应用程序，服务器程序为什么必须先于客户程序运行？对于运行在 UDP 之上的客户-服务器应用程序，客户程序为什么可以先于服务器程序运行？

> 基于 TCP 的程序，客户端必须与服务器程序建立持续性的连接，所以服务器程序必须先于客户程序打开。基于 UDP 的程序，客户程序不需要与服务器程序建立持续性连接，所以服务器程序不用提前打开，因为基于 UDP 的客户程序本身并不期待报文能无差错可靠的到达，或者它由应用层的代码来保证可靠性。

 


