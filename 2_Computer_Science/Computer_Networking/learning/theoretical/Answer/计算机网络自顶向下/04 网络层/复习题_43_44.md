#### R7 讨论为什么在高速路由器的每个输入端口都存储转发表的影子副本

  * 路由器中的转发表由路由选择处理器计算并更新，路由选择处理器通过总线将转发表复制到线路卡，通过在每个输入端口存储转发表的影子副本，转发查询操作可以在本地作出，而无需调用路由选择处理器，这样查表操作就能避免成为转发操作的瓶颈所在。

#### R8 在 4.3 节中讨论了 3 种交换结构。列出并简要讨论每一类交换结构。哪一种 (如果有的话) 能够跨越交换结构并行发送多个分组？

  * 经内存交换
  	 * 这种交换方式受限于内存的读写速度，下面为步骤
  	 * 分组到达输入链路，发送信号给路由选择处理器
  	 * 路由选择处理器提取分组首部的 IP 字段，进行最长前缀匹配，决定导入哪条输出链路
  	 * 路由选择处理器把分组复制到输出链路

  * 经共享总线交换
  	* 不经由路由选择处理器，下面为步骤
  	* 分组到达输入链路，被添加一个标签
  	* 分组进入总线传输，每个输出端口都可以收到该分组，但只有标签匹配的才能保存
  	* 分组被标签匹配的输出端口保存，然后去掉该标签

  * 经互联网络交换
  	* 经过多个交叉的共享总线传输
  	
  * 经互联网络的交换能够并行发送多个分组，但如果两个分组的输出端口相同，那么必有一个后到的分组被阻塞。
  
 #### R9 描述在输入端口会出现分组丢失的原因。描述在输入端口如何消除分组丢失 (不使用无限大缓存区)
 
   * 如果分组到达输入链路的速率超过了交换结构处理分组的速率，那么就会产生排队，如果这种速度的不匹配持续下去，那么分组的队列将越来越长，最终产生丢包。
   * 在输入端口消除分组丢失的方式是使交换结构的速率尽可能大，比如输入链路 A 的分组到达速率为 v1，输入链路 B 的分组到达速率为 v2，以此类推，那么为了消除输入链路的丢包，交换结构的速率至少为 `v1 + v2 + v3 + ... + vN`，N 是输入链路的个数。

#### R10 描述在输出端口出现分组丢失的原因。通过增加交换结构速率，能够防止这种丢失吗？

  * 如果输入链路在 t0 时刻到达 N 个分组，交换结构足够快，能够在 t1 时刻把这些分组转发到输出链路。但是，如果这 N 个分组都被转发到同一条输出链路(即它们目的地相同)，那么在 t1 时刻输出链路 A 累计的分组数目为 N，但 t2 时刻，只有 1 个被发送出去了；如果同样在 t2 时刻，输入链路又到达 N 个分组，并且目的地都相同，都将被转发到输出链路 A，那么 t3 时刻该输出链路净累计 `2N-2` 个分组，这样下去，输出链路的缓存将很快被耗尽。增加交换结构速率对于防止输出端口的分组丢失于事无补。
  
#### R11 什么是 HOL 阻塞？它出现在输入端口还是输出端口？

  * HOL 阻塞出现在输入端口
  
  * 假设有 A、B 两条输入链路, D、E 两条输出链路。
  * t0 时刻，输入链路 A 到达了分组 1，输入链路 B 到达了分组 2 和分组 3，其中，分组 1 和 2 要去往 D，分组 3 要去往 E 
  * t1 时刻，交换结构处理分组 1，此时分组 2 ，3 均被阻塞。
  * 从上面的例子可以看出，分组 3 需要被转发到输出链路 E，尽管 E 一直处于空闲状态，但是因为分组 2 排在分组 3 前面，并且分组 2 被分组 1 阻塞，于是分组 3 也被连带着阻塞。这种现象叫做 HOL 阻塞。
  
#### R12 路由器有 IP 地址吗？如果有，有多少个？

  * 路由器有 IP 地址，IP 地址对应于路由器的接口，有多少个接口就有多少个 IP 地址。

#### R13 IP 地址 223.1.3.27 的 32 比特二进制等价形式是什么？

  * 223 ===> 128 + 64 + 16 + 8 + 4 + 2 + 1 ===> 1101 1111

  * 1 ===> 0000 0001

  * 3 ===> 0000 0011 

  * 27 ===> 16 + 8 + 2 + 1 ===> 0000 1111

  * 二进制形式为 `1101 1111 0000 0001 0000 0011 0000 1111`

#### R14 考察使用 DHCP 的主机，获得它的 IP 地址、网络掩码、默认路由器和其本地 DNS 服务器的 IP 地址。列出这些值。

  * 连上公司的 WIFI 后

  * 获得的 IP 地址是 `10.10.3.36`
  * 子网掩码 `255.255.255.0`
  * 路由器 `10.10.3.1`
  * 本地 DNS 服务器是 `119.29.29.29`
  
#### R15 假设在一个源主机和一个目的主机之间有 3 台路由器。不考虑分片，一个从源主机发送给目的主机的 IP 报文将通过多少个接口？为了将数据从源移动到目的地需要检索多少个转发表？

  * ![](https://github.com/YangXiaoHei/Networking/blob/master/04%20网络层/images/r15.png)
  
 
#### R16 假设某应用每 20 ms 生成一个 40 字节的数据块，每块封装在一个 TCP 报文段中，TCP 报文段再封装在一个 IP 数据报中。每个数据报的开销有多大？应用数据所占百分比是多少？

   * TCP 报文段首部总共 20 字节，**IPv4** 首部 20 字节，总共 `40 + 40 = 80` 字节，其中应用程序所占百分比为 `40 / 80 = 50%`

#### R17 假定主机 A 向主机 B 发送封装在一个 IP 数据报中的 TCP 报文段。当主机 B 接收到该数据报时，主机 B 中的网络层怎么知道它应当将该报文段（即数据报的有效载荷）交给 TCP 而不是 UDP 或某个其他东西呢?

* 主机 B 的网络层通过检查 **IPv4** 数据报首部的 "上层协议" 字段来确定应该将网络层数据报交给 UDP 还是 TCP 或者其他什么东西。

#### R18 假定你购买了一个无线路由器并将其与电缆调制解调器相连。同时假定 ISP 动态地为你连接的设备（即你的无线路由器）分配一个 IP 地址。还假定你家有 5 台 PC，均使用 802.11 以无线方式与该无线路由器相连。怎样为这 5 台 PC 分配 IP 地址？该无线路由器使用 NAT 吗？为什么？

  * 在无线路由中有一个 DHCP 服务器，通过 DHCP 服务器为家中的 PC 分配 IP 地址，无线路由器使用 NAT，因为无线路由器仅从 ISP 获得一个 IP 地址。
  
#### R19 比较并比照 **IPv4** 和 **IPv6** 首部字段。它们有某些字段是相同的吗？
  * 下面列出的字段在用意上是一致的。
  * **IPv4** 中的 **版本号** 字段与 **IPv6** 中的 **版本号**  相同
  * **IPv4** 中的 **数据报长度** 字段和 **IPv6** 中的 **有效载荷长度** 相同
  * **IPv4** 中的 **TTL** 字段和 **IPv6** 中的 **跳限制** 相同
  * **IPv4** 中的 **服务类型** 字段和 **IPv6** 中的 **流量类型** 相同
  * **IPv4** 中的 **上层协议** 字段和 **IPv6** 中的 **下一首部** 相同
  
#### R20 有人说当 **IPv6** 建隧道通过 **IPv4** 路由器时，**IPv6** 将 **IPv4** 隧道作为链路层协议。你同意这种说法吗？为什么？

 *  我....勉强同意吧，很形象。因为 **IPv6** 是包在 **IPv4** 里面，作为数据的一部分传输的。**IPv6** 相当于把 **IPv4** 的首部当成了 "链路层首部"。


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
